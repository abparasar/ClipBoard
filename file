# --- 1. Check GPU ---
import torch
device = 'cuda' if torch.cuda.is_available() else 'cpu'
print(f"Using device: {device}")

# --- 2. Clone SimSwap repo ---
!git clone https://github.com/neuralchen/SimSwap
%cd SimSwap

# --- 3. Install requirements ---
!pip install -r requirements.txt
!pip install insightface==0.2.1 onnxruntime moviepy

# --- 4. Create folders ---
!mkdir -p arcface_model
!mkdir -p checkpoints/people

# --- 5. Download models (no authentication needed) ---
!wget https://github.com/neuralchen/SimSwap/releases/download/1.0/arcface_checkpoint.tar -P ./arcface_model/
!wget https://github.com/neuralchen/SimSwap/releases/download/1.0/checkpoints.zip
!unzip -o checkpoints.zip -d ./checkpoints/
!mv checkpoints/people/epoch_00020.pth ./checkpoints/people/

# --- 6. Extract ArcFace ---
!tar -xvf arcface_model/arcface_checkpoint.tar -C arcface_model/