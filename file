# --- 7. Setup imports ---
import os
import cv2
import numpy as np
from PIL import Image
from types import SimpleNamespace

# --- 8. Setup Options manually ---
opt = SimpleNamespace(
    name = 'people',
    use_mask = False,
    output_path = './output/',
    crop_size = 224,
    isTrain = False,
    gpu_ids = [0],
    checkpoints_dir = './checkpoints',
    batch_size = 1
)

# --- 9. Load SimSwap Model ---
from models.models import create_model
model = create_model(opt)
model.load_networks('checkpoints/people/epoch_00020.pth')
model.eval()
model = model.to(device)

# --- 10. Load ArcFace Model ---
import sys
sys.path.append('./arcface_model')
from models import iresnet

arcface = iresnet.iresnet100(pretrained=False)
arcface.load_state_dict(torch.load('arcface_model/backbone.pth', map_location='cpu'))
arcface = arcface.eval().to(device)