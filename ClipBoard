from email import policy
from email.parser import BytesParser

# Path to your .mhtml file and the desired output HTML file
mhtml_file = 'path/to/your/file.mhtml'
html_file = 'output_file.html'

# Step 1: Read and extract content from the .mhtml file
with open(mhtml_file, 'rb') as f:
    msg = BytesParser(policy=policy.default).parse(f)

# Step 2: Extract the HTML content
html_content = None

# Iterate through the parts of the .mhtml file to find the HTML part
for part in msg.iter_parts():
    if part.get_content_type() == 'text/html':
        html_content = part.get_payload(decode=True).decode(part.get_content_charset())
        break

# Step 3: Save the extracted HTML content to a new HTML file
if html_content:
    with open(html_file, 'w', encoding='utf-8') as output_file:
        output_file.write(html_content)
    print(f"HTML content has been successfully saved to {html_file}")
else:
    print("No HTML content found in the .mhtml file.")