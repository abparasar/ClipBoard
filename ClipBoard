import torch
from transformers import BertForSequenceClassification
from torchviz import make_dot

# Load the model
model = BertForSequenceClassification.from_pretrained('bert-base-uncased')

# Create a dummy input tensor
inputs = torch.ones((1, 10), dtype=torch.long)  # Batch size of 1, sequence length of 10

# Perform a forward pass
outputs = model(inputs)

# Generate the visualization
dot = make_dot(outputs.logits, params=dict(model.named_parameters()))
dot.render('bert_model_architecture', format='png')  # Save as PNG