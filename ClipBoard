from sklearn.metrics import classification_report

# All possible class IDs
all_class_ids = list(range(len(le.classes_)))

report = classification_report(
    y_true=all_labels,
    y_pred=all_preds,
    labels=all_class_ids,                # ← Ensures all classes are expected
    target_names=le.classes_,            # ← Matches label IDs
    zero_division=0,                     # ← Avoid divide-by-zero warnings
    output_dict=True
)