# Get predicted probabilities
probs = torch.softmax(outputs.logits, dim=1)

# Index of 'card_decline_problem' in the label encoder
card_idx = le.transform(['card_decline_problem'])[0]

# Apply threshold
threshold = 0.8
pred_label = 'card_decline_problem' if probs[0][card_idx] > threshold else 'other'