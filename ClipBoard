import subprocess
import time
import psutil

def get_chrome_pids():
    """Get a list of all Chrome process IDs."""
    pids = []
    for proc in psutil.process_iter(['pid', 'name']):
        if proc.info['name'] == 'chrome.exe':
            pids.append(proc.info['pid'])
    return pids

def close_specific_chrome_window(target_pid):
    """Close a specific Chrome window by PID."""
    try:
        os.system(f'taskkill /PID {target_pid} /F')
        print(f'Closed Chrome window with PID {target_pid}')
    except Exception as e:
        print(f'Error closing Chrome window: {e}')

# Open a new Chrome window (adjust path if necessary)
subprocess.Popen(["C:/Program Files/Google/Chrome/Application/chrome.exe", "--new-window", "https://www.example.com"])

# Wait for a while to ensure the window is opened
time.sleep(10)

# Get a list of all Chrome PIDs
chrome_pids = get_chrome_pids()

# Example: Close the first Chrome window found (replace with your target PID)
if chrome_pids:
    target_pid = chrome_pids[0]  # Adjust this as needed
    close_specific_chrome_window(target_pid)
else:
    print("No Chrome processes found.")