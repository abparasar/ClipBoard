from sklearn.metrics import confusion_matrix
import seaborn as sns
import matplotlib.pyplot as plt

# Assuming df has 'true_label' and 'predicted_label' columns
y_true = df['true_label']
y_pred = df['predicted_label']

# Optionally, convert to consistent label set (same ordering)
from sklearn.preprocessing import LabelEncoder

le = LabelEncoder()
all_labels = pd.concat([y_true, y_pred])
le.fit(all_labels)

y_true_enc = le.transform(y_true)
y_pred_enc = le.transform(y_pred)
label_names = le.classes_

# Compute confusion matrix
cm = confusion_matrix(y_true_enc, y_pred_enc)

# Display with heatmap
plt.figure(figsize=(10, 8))
sns.heatmap(cm, annot=True, fmt='d', xticklabels=label_names, yticklabels=label_names, cmap="Blues")
plt.xlabel("Predicted")
plt.ylabel("Actual")
plt.title("Confusion Matrix")
plt.tight_layout()
plt.show()