import pycld3
import pandas as pd

# Sample data
df = pd.DataFrame({
    'utterance': [
        "hello",
        "oye",
        "cÃ³mo estÃ¡s",
        "haan theek hai",
        "fax a complaint",
        "bonjour",
        "what's your name?",
    ]
})

# Function to detect English
def is_english(text):
    try:
        result = pycld3.get_language(text)
        return result.language == 'en' and result.probability > 0.85
    except:
        return False

# Apply detection
df['is_english'] = df['utterance'].apply(is_english)

# Split
df_english = df[df['is_english']].reset_index(drop=True)
df_non_english = df[~df['is_english']].reset_index(drop=True)

# Print result
print("âœ… English utterances:")
print(df_english)

print("\nðŸš« Non-English utterances:")
print(df_non_english)