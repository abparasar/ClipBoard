from langdetect import detect, DetectorFactory
import pandas as pd

# Ensure consistent language detection
DetectorFactory.seed = 0

# Sample DataFrame
df = pd.DataFrame({
    'utterance': [
        "Hello, how are you?",           # English
        "नमस्ते, आप कैसे हैं?",         # Hindi
        "Bonjour, comment ça va ?",     # French
        "What is your name?",           # English
        "你叫什么名字？",                # Chinese
    ]
})

# Function to detect if text is English
def is_english(text):
    try:
        return detect(text) == 'en'
    except:
        return False  # On detection error, treat as non-English

# Create English and non-English DataFrames
df_english = df[df['utterance'].apply(is_english)].reset_index(drop=True)
df_non_english = df[~df['utterance'].apply(is_english)].reset_index(drop=True)

# Show the results
print("✅ English utterances:")
print(df_english)

print("\n🚫 Non-English utterances:")
print(df_non_english)